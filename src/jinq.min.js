(function(n,t){if(typeof module!="undefined")module.exports=t();else if(typeof define=="function"&&typeof define.amd=="object")define(t);else{var i=this[n];this[n]=t();i&&(this[n].noConflict=i)}})("jinq",function(){function r(n){this.list=n||[];this.queue=[]}function n(n){return typeof n=="string"?function(t){return t[n]}:n}function e(n,t){function u(n){return t?function(t,i){return t[n]>i[n]?-1:i[n]>t[n]?1:0}:function(t,i){return t[n]>i[n]?1:i[n]>t[n]?-1:0}}for(var r,i=n.length;i--;)r=n[i],typeof r!="function"&&(n[i]=u(r));return function(t,i){for(var r=0,f=n.length,u;r<f;r++)if(u=n[r](t,i),u)return u;return 0}}function t(n){for(var r,t=n.list.slice(),i=0,u=n.queue.length;i<u;i++)r=n.queue[i],t=r[0].apply(t,r[1]);return t}function o(t,i){var f={},r,o,u,e;for(i=n(i),r=0,o=t.length;r<o;r++)u=t[r],e=i?i.call(t,u,r):u,f[e]?f[e].push(u):f[e]=[u];return f}function s(t,i){i=n(i);for(var r=0,u=t.length;r<u;r++)if(!i.call(t,t[r],r))break;return r}var u,f,i;r.prototype={aggregate:function(n,i){var r=this,o;t(r);var u=i===0?0:i||null,f=0,e=r.list.length;if(e==0)return u;for(u===null&&(u=r.list[0],f=1),e=r.list.length;f<e;f++)o=r.list[f],u=n.call(r.list,u,o,f);return u},all:function(i){var u=this,r,f;if(t(u),i=n(i),i){for(r=0,f=u.list.length;r<f;r++)if(!i.call(u.list,u.list[r],r))return!1;return!0}},any:function(n){return!!this.first(n)},average:function(){return this.sum()/this.list.length},contains:function(n){return t(this),this.list.indexOf(n)!==-1},count:function(n){return this.toArray(n).length},elementAt:function(n){var t=this.toArray();return n<t.length?t[n]:null},first:function(n){var t=this.toArray(n),i=t.length;return i?t[0]:null},last:function(n){var t=this.toArray(n),i=t.length;return i?t[t.length-1]:null},max:function(){return t(this),Math.max.apply(null,this.list)},min:function(){return t(this),Math.min.apply(null,this.list)},single:function(n){var t=this.first(n);return this.list.length===1?t:null},sum:function(){var n,i;for(t(this),n=0,i=this.list;i--;)n+=this.list[i];return n},toArray:function(n){return n&&this.queue.push([u.where,arguments]),t(this),this.list},toDictionary:function(i,r){var e,f,o,u,s;for(t(this),i=n(i),r=n(r),e={},f=0,o=this.list.length;f<o;f++)u=this.list[f],s=i?i(u):u,e[s]=r?r(u):u;return e},toLookup:function(n){return t(this),o(this.list,n)}};u={concat:function(n){return this.concat(n)},defaultIfEmpty:function(n){return this.length?this:[n]},distinct:function(t){var u,f,i,o,r,e;for(t=n(t),u=[],f={},i=0,o=this.length;i<o;i++)(r=this[i],e=t?t.call(this,r,i):r,f[e])||(f[e]=!0,u.push(r));return u},except:function(t,i){i=n(i);for(var o=[],s={},r=0,e=t.length,u,f;r<e;r++)u=t[r],f=i?i.call(t,u,r):u,s[f]=!0;for(r=0,e=this.length;r<e;r++)u=this[r],f=i?i.call(this,u,r):u,s[f]||o.push(u);return o},groupBy:function(n){var t=o(this,n),i=[];for(var r in t)i.push({key:r,value:t[r]});return i},groupJoin:function(t,i,r,u){var c;if(i=n(i),r=n(r),i&&r){for(var l=[],s={},e=0,h=t.length,o,f;e<h;e++)o=t[e],f=r(o),f&&(s[f]?s[f].push(o):s[f]=[o]);for(e=0,h=this.length;e<h;e++)o=this[e],f=i(o),f&&(c=s[f],c&&l.push(u?u.call(this,o,s[f],e):c));return l}},intersect:function(t,i){i=n(i);for(var o=[],s={},r=0,e=t.length,u,f;r<e;r++)u=t[r],f=i?i.call(t,u,r):u,s[f]=!0;for(r=0,e=this.length;r<e;r++)u=this[r],f=i?i.call(this,u,r):u,s[f]&&o.push(u);return o},join:function(t,i,r,u){var s,h;if(i=n(i),r=n(r),i&&r){for(var a=[],c={},e=0,l=t.length,f,o;e<l;e++)f=t[e],o=r(f),o&&(c[o]=f);for(e=0,l=this.length;e<l;e++)if(f=this[e],o=i(f),o&&(s=c[o],s)){if(u)f=u.call(this,f,c[o],e);else for(h in s)f[h]||(f[h]=s[h]);a.push(f)}return a}},orderBy:function(n){return this.sort(n?e(arguments):n),this},orderByDescending:function(n){return this.sort(n?e(arguments,!0):function(n,t){return n>t?-1:t>n?1:0}),this},reverse:function(){for(var n=[],t=this.length;t--;)n.push(this[t]);return n},select:function(t){var r,i,u,f,e;if(t=n(t),t){for(r=[],i=0,u=this.length;i<u;i++)f=this[i],e=t.call(this,f,i),r.push(e);return r}},selectMany:function(t){var r,i,u,f,e;if(t=n(t),t){for(r=[],i=0,u=this.length;i<u;i++)f=this[i],e=t.call(this,f,i),r.concat(e);return r}},shuffle:function(){for(var n=this.length,t,i;n--;)t=Math.floor(Math.random()*(n+1)),i=this[n],this[n]=this[t],this[t]=i;return this},skip:function(n){return this.slice(n)},skipWhile:function(n){var t=s(this,n);return this.slice(t)},take:function(n){return this.slice(0,n)},takeWhile:function(n){var t=s(this,n);return this.slice(0,t)},union:function(t,i){i=n(i);for(var o=[],e={},r=0,s=this.length,u,f;r<s;r++)u=this[r],f=i?i.call(this,u,r):u,e[f]||(e[f]=!0,o.push(u));for(r=0,s=t.length;r<s;r++)u=t[r],f=i?i.call(t,u,r):u,e[f]||(e[f]=!0,o.push(u));return o},where:function(t){var r,i,f,u;if(t=n(t),t){for(r=[],i=0,f=this.length;i<f;i++)u=this[i],t.call(this,u,i)&&r.push(u);return r}},zip:function(t,i){var r;if(i=n(i),i){var u=[],f=this.length,e=t.length,o=f<e?f:e;for(r=0;r<o;r++){var s=this[r],h=t[r],c=i.call(this,s,h,r);u.push(c)}return u}}};for(f in u)r.prototype[f]=function(n){return function(){var t=new r(this.list);return t.queue=this.queue.slice(),t.queue.push([n,arguments]),t}}(u[f]);return i=function(n){return new r(n)},i.empty=function(){return new r},i.range=function(n,t){for(var r=[],u=n+t;n<u;n++)r.push(n);return i(r)},i.repeat=function(n,t){for(var r=[],u=0;u<t;u++)r.push(n);return i(r)},i});