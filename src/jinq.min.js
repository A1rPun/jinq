(function(n,t){if(typeof module!="undefined")module.exports=t();else if(typeof define=="function"&&typeof define.amd=="object")define(t);else{var i=this[n];this[n]=t();i&&(this[n].noConflict=i)}})("jinq",function(){function t(n,t){n?(this.list=n.list,this.queue=n.queue.slice(),t&&this.queue.push(t)):(this.list=[],this.queue=[])}var i,r,n;t.prototype={__createCallback:function(n){return typeof n=="string"?function(t){return t[n]}:n},__makeOrderBy:function(n,t){function u(n){return t?function(t,i){return t[n]>i[n]?-1:i[n]>t[n]?1:0}:function(t,i){return t[n]>i[n]?1:i[n]>t[n]?-1:0}}for(var r,i=n.length;i--;)r=n[i],typeof r!="function"&&(n[i]=u(r));return function(t,i){for(var r=0,f=n.length,u;r<f;r++)if(u=n[r](t,i),u)return u;return 0}},__resolveQueue:function(){var n,i,t;for(this.list=this.list.slice(),n=0,i=this.queue.length;n<i;n++)t=this.queue[n],t[0].apply(this,t[1])},__toLookup:function(n){var r={},t,f,i,u;for(n=me.__createCallback(n),t=0,f=this.list.length;t<f;t++)i=this.list[t],u=n?n.call(this.list,i,t):i,r[u]?r[u].push(i):r[u]=[i];return r},__while:function(n){n=this.__createCallback(n);for(var t=0,i=this.list.length;t<i;t++)if(!n.call(this.list,this.list[t],t))break;return t},aggregate:function(n,t){var i=this,e;i.__resolveQueue();var r=t===0?0:t||null,u=0,f=i.list.length;if(f==0)return r;for(r===null&&(r=i.list[0],u=1),f=i.list.length;u<f;u++)e=i.list[u],r=n.call(i.list,r,e,u);return r},all:function(n){var t=this,i,r;if(t.__resolveQueue(),n=t.__createCallback(n),n){for(i=0,r=t.list.length;i<r;i++)if(!n.call(t.list,t.list[i],i))return!1;return!0}},any:function(n){return!!this.first(n)},average:function(){return this.sum()/this.list.length},contains:function(n){return this.__resolveQueue(),this.list.indexOf(n)!==-1},count:function(n){return this.toArray(n).length},elementAt:function(n){var t=this.toArray();return n<t.length?t[n]:null},first:function(n){var t=this.toArray(n),i=t.length;return i?t[0]:null},last:function(n){var t=this.toArray(n),i=t.length;return i?t[t.length-1]:null},max:function(){return this.__resolveQueue(),Math.max.apply(null,this.list)},min:function(){return this.__resolveQueue(),Math.min.apply(null,this.list)},single:function(n){var t=this.first(n);return this.list.length===1?t:null},sum:function(){var n,t;for(this.__resolveQueue(),n=0,t=this.list;t--;)n+=this.list[t];return n},toArray:function(n){return n&&this.queue.push([i.where,arguments]),this.__resolveQueue(),this.list},toDictionary:function(n,t){var i=this,f,u,e,r,o;for(i.__resolveQueue(),n=i.__createCallback(n),t=i.__createCallback(t),f={},u=0,e=i.list.length;u<e;u++)r=i.list[u],o=n?n(r):r,f[o]=t?t(r):r;return f},toLookup:function(n){return this.__resolveQueue(),this.__toLookup(n)}};i={concat:function(n){this.list=this.list.concat(n)},defaultIfEmpty:function(n){this.list.length||(this.list=[n])},distinct:function(n){var t=this,u,f,i,o,r,e;for(n=t.__createCallback(n),u=[],f={},i=0,o=t.list.length;i<o;i++)(r=t.list[i],e=n?n.call(t.list,r,i):r,f[e])||(f[e]=!0,u.push(r));t.list=u},except:function(n,t){var u=this;t=u.__createCallback(t);for(var o=[],s={},i=0,e=n.length,r,f;i<e;i++)r=n[i],f=t?t.call(n,r,i):r,s[f]=!0;for(i=0,e=u.list.length;i<e;i++)r=u.list[i],f=t?t.call(u.list,r,i):r,s[f]||o.push(r);u.list=o},groupBy:function(n){var t=this.__toLookup(n),i=[];for(var r in t)i.push({key:r,value:t[r]});this.list=i},groupJoin:function(n,t,i,r){var o=this,c;if(t=o.__createCallback(t),i=o.__createCallback(i),t&&i){for(var l=[],s={},f=0,h=n.length,e,u;f<h;f++)e=n[f],u=i(e),u&&(s[u]?s[u].push(e):s[u]=[e]);for(f=0,h=o.list.length;f<h;f++)e=o.list[f],u=t(e),u&&(c=s[u],c&&l.push(r?r.call(o.list,e,s[u],f):c));o.list=l}},intersect:function(n,t){var u=this;t=u.__createCallback(t);for(var o=[],s={},i=0,e=n.length,r,f;i<e;i++)r=n[i],f=t?t.call(n,r,i):r,s[f]=!0;for(i=0,e=u.list.length;i<e;i++)r=u.list[i],f=t?t.call(u.list,r,i):r,s[f]&&o.push(r);u.list=o},join:function(n,t,i,r){var o=this,s,h;if(t=o.__createCallback(t),i=o.__createCallback(i),t&&i){for(var a=[],c={},f=0,l=n.length,u,e;f<l;f++)u=n[f],e=i(u),e&&(c[e]=u);for(f=0,l=o.list.length;f<l;f++)if(u=o.list[f],e=t(u),e&&(s=c[e],s)){if(r)u=r.call(o.list,u,c[e],f);else for(h in s)u[h]||(u[h]=s[h]);a.push(u)}o.list=a}},orderBy:function(n){this.list.sort(n?this.__makeOrderBy(arguments):n)},orderByDescending:function(n){this.list.sort(n?this.__makeOrderBy(arguments,!0):function(n,t){return n>t?-1:t>n?1:0})},reverse:function(){for(var n=this,t=[],i=n.list.length;i--;)t.push(n.list[i]);n.list=t},select:function(n){var t=this,r,i,u,f,e;if(n=t.__createCallback(n),n){for(r=[],i=0,u=t.list.length;i<u;i++)f=t.list[i],e=n.call(t.list,f,i),r.push(e);t.list=r}},selectMany:function(n){var t=this,r,i,u,f,e;if(n=t.__createCallback(n),n){for(r=[],i=0,u=t.list.length;i<u;i++)f=t.list[i],e=n.call(t.list,f,i),r.concat(e);t.list=r}},shuffle:function(){for(var n=this.list.length,t,i;n--;)t=Math.floor(Math.random()*(n+1)),i=this.list[n],this.list[n]=this.list[t],this.list[t]=i},skip:function(n){this.list=this.list.slice(n)},skipWhile:function(n){var t=this.__while(n);this.list=this.list.slice(t)},take:function(n){this.list=this.list.slice(0,n)},takeWhile:function(n){var t=this.__while(n);this.list=this.list.slice(0,t)},union:function(n,t){var f=this;t=f.__createCallback(t);for(var o=[],e={},i=0,s=f.list.length,r,u;i<s;i++)r=f.list[i],u=t?t.call(f.list,r,i):r,e[u]||(e[u]=!0,o.push(r));for(i=0,s=n.length;i<s;i++)r=n[i],u=t?t.call(n,r,i):r,e[u]||(e[u]=!0,o.push(r));f.list=o},where:function(n){var t=this,r,i,f,u;if(n=t.__createCallback(n),n){for(r=[],i=0,f=t.list.length;i<f;i++)u=t.list[i],n.call(t.list,u,i)&&r.push(u);t.list=r}},zip:function(n,t){var r=this,i;if(t=r.__createCallback(t),t){var u=[],f=r.list.length,e=n.length,o=f<e?f:e;for(i=0;i<o;i++){var s=r.list[i],h=n[i],c=t.call(r.list,s,h,i);u.push(c)}r.list=u}}};for(r in i)t.prototype[r]=function(n){return function(){return new t(this,[n,arguments])}}(i[r]);return n=function(n){var i=new t;return i.list=n,i},n.empty=function(){return new t},n.range=function(t,i){for(var r=[],u=t+i;t<u;t++)r.push(t);return n(r)},n.repeat=function(t,i){for(var r=[],u=0;u<i;u++)r.push(t);return n(r)},n});