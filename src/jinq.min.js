(function(n,t){if(typeof module!="undefined")module.exports=t();else if(typeof define=="function"&&typeof define.amd=="object")define(t);else{var i=this[n];this[n]=t();i&&(this[n].noConflict=i)}})("jinq",function(){function r(n,t){n?(this.list=n.list,this.queue=n.queue.slice(),t&&this.queue.push(t)):(this.list=[],this.queue=[])}function n(n){return typeof n=="string"?function(t){return t[n]}:n}function e(n,t){function u(n){return t?function(t,i){return t[n]>i[n]?-1:i[n]>t[n]?1:0}:function(t,i){return t[n]>i[n]?1:i[n]>t[n]?-1:0}}for(var r,i=n.length;i--;)r=n[i],typeof r!="function"&&(n[i]=u(r));return function(t,i){for(var r=0,f=n.length,u;r<f;r++)if(u=n[r](t,i),u)return u;return 0}}function t(n){var t,r,i;for(n.list=n.list.slice(),t=0,r=n.queue.length;t<r;t++)i=n.queue[t],i[0].apply(n,i[1])}function o(t,i){var f={},r,o,u,e;for(i=n(i),r=0,o=t.length;r<o;r++)u=t[r],e=i?i.call(t,u,r):u,f[e]?f[e].push(u):f[e]=[u];return f}function s(t,i){i=n(i);for(var r=0,u=t.length;r<u;r++)if(!i.call(t,t[r],r))break;return r}var u,f,i;r.prototype={aggregate:function(n,i){var r=this,o;t(r);var u=i===0?0:i||null,f=0,e=r.list.length;if(e==0)return u;for(u===null&&(u=r.list[0],f=1),e=r.list.length;f<e;f++)o=r.list[f],u=n.call(r.list,u,o,f);return u},all:function(i){var u=this,r,f;if(t(u),i=n(i),i){for(r=0,f=u.list.length;r<f;r++)if(!i.call(u.list,u.list[r],r))return!1;return!0}},any:function(n){return!!this.first(n)},average:function(){return this.sum()/this.list.length},contains:function(n){return t(this),this.list.indexOf(n)!==-1},count:function(n){return this.toArray(n).length},elementAt:function(n){var t=this.toArray();return n<t.length?t[n]:null},first:function(n){var t=this.toArray(n),i=t.length;return i?t[0]:null},last:function(n){var t=this.toArray(n),i=t.length;return i?t[t.length-1]:null},max:function(){return t(this),Math.max.apply(null,this.list)},min:function(){return t(this),Math.min.apply(null,this.list)},single:function(n){var t=this.first(n);return this.list.length===1?t:null},sum:function(){var n,i;for(t(this),n=0,i=this.list;i--;)n+=this.list[i];return n},toArray:function(n){return n&&this.queue.push([u.where,arguments]),t(this),this.list},toDictionary:function(i,r){var e=this,o,f,s,u,h;for(t(e),i=n(i),r=n(r),o={},f=0,s=e.list.length;f<s;f++)u=e.list[f],h=i?i(u):u,o[h]=r?r(u):u;return o},toLookup:function(n){return t(this),o(this.list,n)}};u={concat:function(n){this.list=this.list.concat(n)},defaultIfEmpty:function(n){this.list.length||(this.list=[n])},distinct:function(t){var r=this,f,e,i,s,u,o;for(t=n(t),f=[],e={},i=0,s=r.list.length;i<s;i++)(u=r.list[i],o=t?t.call(r.list,u,i):u,e[o])||(e[o]=!0,f.push(u));r.list=f},except:function(t,i){var f=this;i=n(i);for(var s=[],h={},r=0,o=t.length,u,e;r<o;r++)u=t[r],e=i?i.call(t,u,r):u,h[e]=!0;for(r=0,o=f.list.length;r<o;r++)u=f.list[r],e=i?i.call(f.list,u,r):u,h[e]||s.push(u);f.list=s},groupBy:function(n){var t=o(this.list,n),i=[];for(var r in t)i.push({key:r,value:t[r]});this.list=i},groupJoin:function(t,i,r,u){var h=this,l;if(i=n(i),r=n(r),i&&r){for(var a=[],s={},e=0,c=t.length,o,f;e<c;e++)o=t[e],f=r(o),f&&(s[f]?s[f].push(o):s[f]=[o]);for(e=0,c=h.list.length;e<c;e++)o=h.list[e],f=i(o),f&&(l=s[f],l&&a.push(u?u.call(h.list,o,s[f],e):l));h.list=a}},intersect:function(t,i){var f=this;i=n(i);for(var s=[],h={},r=0,o=t.length,u,e;r<o;r++)u=t[r],e=i?i.call(t,u,r):u,h[e]=!0;for(r=0,o=f.list.length;r<o;r++)u=f.list[r],e=i?i.call(f.list,u,r):u,h[e]&&s.push(u);f.list=s},join:function(t,i,r,u){var s=this,h,c;if(i=n(i),r=n(r),i&&r){for(var v=[],l={},e=0,a=t.length,f,o;e<a;e++)f=t[e],o=r(f),o&&(l[o]=f);for(e=0,a=s.list.length;e<a;e++)if(f=s.list[e],o=i(f),o&&(h=l[o],h)){if(u)f=u.call(s.list,f,l[o],e);else for(c in h)f[c]||(f[c]=h[c]);v.push(f)}s.list=v}},orderBy:function(n){this.list.sort(n?e(arguments):n)},orderByDescending:function(n){this.list.sort(n?e(arguments,!0):function(n,t){return n>t?-1:t>n?1:0})},reverse:function(){for(var n=this,t=[],i=n.list.length;i--;)t.push(n.list[i]);n.list=t},select:function(t){var r=this,u,i,f,e,o;if(t=n(t),t){for(u=[],i=0,f=r.list.length;i<f;i++)e=r.list[i],o=t.call(r.list,e,i),u.push(o);r.list=u}},selectMany:function(t){var r=this,u,i,f,e,o;if(t=n(t),t){for(u=[],i=0,f=r.list.length;i<f;i++)e=r.list[i],o=t.call(r.list,e,i),u.concat(o);r.list=u}},shuffle:function(){for(var n=this.list.length,t,i;n--;)t=Math.floor(Math.random()*(n+1)),i=this.list[n],this.list[n]=this.list[t],this.list[t]=i},skip:function(n){this.list=this.list.slice(n)},skipWhile:function(n){var t=s(this.list,n);this.list=this.list.slice(t)},take:function(n){this.list=this.list.slice(0,n)},takeWhile:function(n){var t=s(this.list,n);this.list=this.list.slice(0,t)},union:function(t,i){var e=this;i=n(i);for(var s=[],o={},r=0,h=e.list.length,u,f;r<h;r++)u=e.list[r],f=i?i.call(e.list,u,r):u,o[f]||(o[f]=!0,s.push(u));for(r=0,h=t.length;r<h;r++)u=t[r],f=i?i.call(t,u,r):u,o[f]||(o[f]=!0,s.push(u));e.list=s},where:function(t){var r=this,u,i,e,f;if(t=n(t),t){for(u=[],i=0,e=r.list.length;i<e;i++)f=r.list[i],t.call(r.list,f,i)&&u.push(f);r.list=u}},zip:function(t,i){var u=this,r;if(i=n(i),i){var f=[],e=u.list.length,o=t.length,s=e<o?e:o;for(r=0;r<s;r++){var h=u.list[r],c=t[r],l=i.call(u.list,h,c,r);f.push(l)}u.list=f}}};for(f in u)r.prototype[f]=function(n){return function(){return new r(this,[n,arguments])}}(u[f]);return i=function(n){var t=new r;return t.list=n,t},i.empty=function(){return new r},i.range=function(n,t){for(var r=[],u=n+t;n<u;n++)r.push(n);return i(r)},i.repeat=function(n,t){for(var r=[],u=0;u<t;u++)r.push(n);return i(r)},i});